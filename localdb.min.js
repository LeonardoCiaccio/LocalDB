var CryptoJS=CryptoJS||function(t,e){var r={},n=r.lib={},i=function(){},o=n.Base={extend:function(t){i.prototype=this;var e=new i;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=n.WordArray=o.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=void 0!=e?e:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var e=this.words,r=t.words,n=this.sigBytes;if(t=t.sigBytes,this.clamp(),n%4)for(var i=0;i<t;i++)e[n+i>>>2]|=(r[i>>>2]>>>24-i%4*8&255)<<24-(n+i)%4*8;else if(65535<r.length)for(i=0;i<t;i+=4)e[n+i>>>2]=r[i>>>2];else e.push.apply(e,r);return this.sigBytes+=t,this},clamp:function(){var e=this.words,r=this.sigBytes;e[r>>>2]&=4294967295<<32-r%4*8,e.length=t.ceil(r/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var r=[],n=0;n<e;n+=4)r.push(4294967296*t.random()|0);return new s.init(r,e)}}),a=r.enc={},c=a.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var r=[],n=0;n<t;n++){var i=e[n>>>2]>>>24-n%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new s.init(r,e/2)}},u=a.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var r=[],n=0;n<t;n++)r.push(String.fromCharCode(e[n>>>2]>>>24-n%4*8&255));return r.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new s.init(r,e)}},f=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},l=n.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=f.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var r=this._data,n=r.words,i=r.sigBytes,o=this.blockSize,a=i/(4*o);if(e=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o,i=t.min(4*e,i),e){for(var c=0;c<e;c+=o)this._doProcessBlock(n,c);c=n.splice(0,e),r.sigBytes-=i}return new s.init(c,i)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});n.Hasher=l.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function(t){return function(e,r){return new p.HMAC.init(t,r).finalize(e)}}});var p=r.algo={};return r}(Math);!function(){var t=CryptoJS,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,r=t.sigBytes,n=this._map;t.clamp(),t=[];for(var i=0;i<r;i+=3)for(var o=(e[i>>>2]>>>24-i%4*8&255)<<16|(e[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|e[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;4>s&&i+.75*s<r;s++)t.push(n.charAt(o>>>6*(3-s)&63));if(e=n.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var r=t.length,n=this._map;(i=n.charAt(64))&&(-1!=(i=t.indexOf(i))&&(r=i));for(var i=[],o=0,s=0;s<r;s++)if(s%4){var a=n.indexOf(t.charAt(s-1))<<s%4*2,c=n.indexOf(t.charAt(s))>>>6-s%4*2;i[o>>>2]|=(a|c)<<24-o%4*8,o++}return e.create(i,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,r,n,i,o,s){return((t=t+(e&r|~e&n)+i+s)<<o|t>>>32-o)+e}function r(t,e,r,n,i,o,s){return((t=t+(e&n|r&~n)+i+s)<<o|t>>>32-o)+e}function n(t,e,r,n,i,o,s){return((t=t+(e^r^n)+i+s)<<o|t>>>32-o)+e}function i(t,e,r,n,i,o,s){return((t=t+(r^(e|~n))+i+s)<<o|t>>>32-o)+e}for(var o=CryptoJS,s=(c=o.lib).WordArray,a=c.Hasher,c=o.algo,u=[],f=0;64>f;f++)u[f]=4294967296*t.abs(t.sin(f+1))|0;c=c.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,o){for(var s=0;16>s;s++){var a=t[l=o+s];t[l]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}s=this._hash.words;var c,f,l=t[o+0],p=(a=t[o+1],t[o+2]),h=t[o+3],d=t[o+4],y=t[o+5],v=t[o+6],g=t[o+7],m=t[o+8],w=t[o+9],b=t[o+10],_=t[o+11],x=t[o+12],S=t[o+13],B=t[o+14],E=t[o+15],k=s[0],C=i(C=i(C=i(C=i(C=n(C=n(C=n(C=n(C=r(C=r(C=r(C=r(C=e(C=e(C=e(C=e(C=s[1],f=e(f=s[2],c=e(c=s[3],k=e(k,C,f,c,l,7,u[0]),C,f,a,12,u[1]),k,C,p,17,u[2]),c,k,h,22,u[3]),f=e(f,c=e(c,k=e(k,C,f,c,d,7,u[4]),C,f,y,12,u[5]),k,C,v,17,u[6]),c,k,g,22,u[7]),f=e(f,c=e(c,k=e(k,C,f,c,m,7,u[8]),C,f,w,12,u[9]),k,C,b,17,u[10]),c,k,_,22,u[11]),f=e(f,c=e(c,k=e(k,C,f,c,x,7,u[12]),C,f,S,12,u[13]),k,C,B,17,u[14]),c,k,E,22,u[15]),f=r(f,c=r(c,k=r(k,C,f,c,a,5,u[16]),C,f,v,9,u[17]),k,C,_,14,u[18]),c,k,l,20,u[19]),f=r(f,c=r(c,k=r(k,C,f,c,y,5,u[20]),C,f,b,9,u[21]),k,C,E,14,u[22]),c,k,d,20,u[23]),f=r(f,c=r(c,k=r(k,C,f,c,w,5,u[24]),C,f,B,9,u[25]),k,C,h,14,u[26]),c,k,m,20,u[27]),f=r(f,c=r(c,k=r(k,C,f,c,S,5,u[28]),C,f,p,9,u[29]),k,C,g,14,u[30]),c,k,x,20,u[31]),f=n(f,c=n(c,k=n(k,C,f,c,y,4,u[32]),C,f,m,11,u[33]),k,C,_,16,u[34]),c,k,B,23,u[35]),f=n(f,c=n(c,k=n(k,C,f,c,a,4,u[36]),C,f,d,11,u[37]),k,C,g,16,u[38]),c,k,b,23,u[39]),f=n(f,c=n(c,k=n(k,C,f,c,S,4,u[40]),C,f,l,11,u[41]),k,C,h,16,u[42]),c,k,v,23,u[43]),f=n(f,c=n(c,k=n(k,C,f,c,w,4,u[44]),C,f,x,11,u[45]),k,C,E,16,u[46]),c,k,p,23,u[47]),f=i(f,c=i(c,k=i(k,C,f,c,l,6,u[48]),C,f,g,10,u[49]),k,C,B,15,u[50]),c,k,y,21,u[51]),f=i(f,c=i(c,k=i(k,C,f,c,x,6,u[52]),C,f,h,10,u[53]),k,C,b,15,u[54]),c,k,a,21,u[55]),f=i(f,c=i(c,k=i(k,C,f,c,m,6,u[56]),C,f,E,10,u[57]),k,C,v,15,u[58]),c,k,S,21,u[59]),f=i(f,c=i(c,k=i(k,C,f,c,d,6,u[60]),C,f,_,10,u[61]),k,C,p,15,u[62]),c,k,w,21,u[63]);s[0]=s[0]+k|0,s[1]=s[1]+C|0,s[2]=s[2]+f|0,s[3]=s[3]+c|0},_doFinalize:function(){var e=this._data,r=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;r[i>>>5]|=128<<24-i%32;var o=t.floor(n/4294967296);for(r[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),r[14+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(r.length+1),this._process(),r=(e=this._hash).words,n=0;4>n;n++)i=r[n],r[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return e},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),o.MD5=a._createHelper(c),o.HmacMD5=a._createHmacHelper(c)}(Math),function(){var t,e=CryptoJS,r=(t=e.lib).Base,n=t.WordArray,i=(t=e.algo).EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var r=(a=this.cfg).hasher.create(),i=n.create(),o=i.words,s=a.keySize,a=a.iterations;o.length<s;){c&&r.update(c);var c=r.update(t).finalize(e);r.reset();for(var u=1;u<a;u++)c=r.finalize(c),r.reset();i.concat(c)}return i.sigBytes=4*s,i}});e.EvpKDF=function(t,e,r){return i.create(r).compute(t,e)}}(),CryptoJS.lib.Cipher||function(t){var e=(h=CryptoJS).lib,r=e.Base,n=e.WordArray,i=e.BufferedBlockAlgorithm,o=h.enc.Base64,s=h.algo.EvpKDF,a=e.Cipher=i.extend({cfg:r.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,r){this.cfg=this.cfg.extend(r),this._xformMode=t,this._key=e,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,r,n){return("string"==typeof r?d:p).encrypt(t,e,r,n)},decrypt:function(e,r,n){return("string"==typeof r?d:p).decrypt(t,e,r,n)}}}});e.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=h.mode={},u=function(t,e,r){var n=this._iv;n?this._iv=void 0:n=this._prevBlock;for(var i=0;i<r;i++)t[e+i]^=n[i]},f=(e.BlockCipherMode=r.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();f.Encryptor=f.extend({processBlock:function(t,e){var r=this._cipher,n=r.blockSize;u.call(this,t,e,n),r.encryptBlock(t,e),this._prevBlock=t.slice(e,e+n)}}),f.Decryptor=f.extend({processBlock:function(t,e){var r=this._cipher,n=r.blockSize,i=t.slice(e,e+n);r.decryptBlock(t,e),u.call(this,t,e,n),this._prevBlock=i}}),c=c.CBC=f,f=(h.pad={}).Pkcs7={pad:function(t,e){for(var r,i=(r=(r=4*e)-t.sigBytes%r)<<24|r<<16|r<<8|r,o=[],s=0;s<r;s+=4)o.push(i);r=n.create(o,r),t.concat(r)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},e.BlockCipher=a.extend({cfg:a.cfg.extend({mode:c,padding:f}),reset:function(){a.reset.call(this);var t=(e=this.cfg).iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=e.createEncryptor;else r=e.createDecryptor,this._minBufferSize=1;this._mode=r.call(e,this,t&&t.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var l=e.CipherParams=r.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),p=(c=(h.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return((t=t.salt)?n.create([1398893684,1701076831]).concat(t).concat(e):e).toString(o)},parse:function(t){var e=(t=o.parse(t)).words;if(1398893684==e[0]&&1701076831==e[1]){var r=n.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return l.create({ciphertext:t,salt:r})}},e.SerializableCipher=r.extend({cfg:r.extend({format:c}),encrypt:function(t,e,r,n){n=this.cfg.extend(n);var i=t.createEncryptor(r,n);return e=i.finalize(e),i=i.cfg,l.create({ciphertext:e,key:r,iv:i.iv,algorithm:t,mode:i.mode,padding:i.padding,blockSize:t.blockSize,formatter:n.format})},decrypt:function(t,e,r,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),t.createDecryptor(r,n).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}})),h=(h.kdf={}).OpenSSL={execute:function(t,e,r,i){return i||(i=n.random(8)),t=s.create({keySize:e+r}).compute(t,i),r=n.create(t.words.slice(e),4*r),t.sigBytes=4*e,l.create({key:t,iv:r,salt:i})}},d=e.PasswordBasedCipher=p.extend({cfg:p.cfg.extend({kdf:h}),encrypt:function(t,e,r,n){return r=(n=this.cfg.extend(n)).kdf.execute(r,t.keySize,t.ivSize),n.iv=r.iv,(t=p.encrypt.call(this,t,e,r.key,n)).mixIn(r),t},decrypt:function(t,e,r,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),r=n.kdf.execute(r,t.keySize,t.ivSize,e.salt),n.iv=r.iv,p.decrypt.call(this,t,e,r.key,n)}})}(),function(){for(var t=CryptoJS,e=t.lib.BlockCipher,r=t.algo,n=[],i=[],o=[],s=[],a=[],c=[],u=[],f=[],l=[],p=[],h=[],d=0;256>d;d++)h[d]=128>d?d<<1:d<<1^283;var y=0,v=0;for(d=0;256>d;d++){var g=(g=v^v<<1^v<<2^v<<3^v<<4)>>>8^255&g^99;n[y]=g,i[g]=y;var m=h[y],w=h[m],b=h[w],_=257*h[g]^16843008*g;o[y]=_<<24|_>>>8,s[y]=_<<16|_>>>16,a[y]=_<<8|_>>>24,c[y]=_,_=16843009*b^65537*w^257*m^16843008*y,u[g]=_<<24|_>>>8,f[g]=_<<16|_>>>16,l[g]=_<<8|_>>>24,p[g]=_,y?(y=m^h[h[h[b^m]]],v^=h[h[v]]):y=v=1}var x=[0,1,2,4,8,16,32,64,128,27,54];r=r.AES=e.extend({_doReset:function(){for(var t=(r=this._key).words,e=r.sigBytes/4,r=4*((this._nRounds=e+6)+1),i=this._keySchedule=[],o=0;o<r;o++)if(o<e)i[o]=t[o];else{var s=i[o-1];o%e?6<e&&4==o%e&&(s=n[s>>>24]<<24|n[s>>>16&255]<<16|n[s>>>8&255]<<8|n[255&s]):(s=n[(s=s<<8|s>>>24)>>>24]<<24|n[s>>>16&255]<<16|n[s>>>8&255]<<8|n[255&s],s^=x[o/e|0]<<24),i[o]=i[o-e]^s}for(t=this._invKeySchedule=[],e=0;e<r;e++)o=r-e,s=e%4?i[o]:i[o-4],t[e]=4>e||4>=o?s:u[n[s>>>24]]^f[n[s>>>16&255]]^l[n[s>>>8&255]]^p[n[255&s]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,o,s,a,c,n)},decryptBlock:function(t,e){var r=t[e+1];t[e+1]=t[e+3],t[e+3]=r,this._doCryptBlock(t,e,this._invKeySchedule,u,f,l,p,i),r=t[e+1],t[e+1]=t[e+3],t[e+3]=r},_doCryptBlock:function(t,e,r,n,i,o,s,a){for(var c=this._nRounds,u=t[e]^r[0],f=t[e+1]^r[1],l=t[e+2]^r[2],p=t[e+3]^r[3],h=4,d=1;d<c;d++){var y=n[u>>>24]^i[f>>>16&255]^o[l>>>8&255]^s[255&p]^r[h++],v=n[f>>>24]^i[l>>>16&255]^o[p>>>8&255]^s[255&u]^r[h++],g=n[l>>>24]^i[p>>>16&255]^o[u>>>8&255]^s[255&f]^r[h++];p=n[p>>>24]^i[u>>>16&255]^o[f>>>8&255]^s[255&l]^r[h++],u=y,f=v,l=g}y=(a[u>>>24]<<24|a[f>>>16&255]<<16|a[l>>>8&255]<<8|a[255&p])^r[h++],v=(a[f>>>24]<<24|a[l>>>16&255]<<16|a[p>>>8&255]<<8|a[255&u])^r[h++],g=(a[l>>>24]<<24|a[p>>>16&255]<<16|a[u>>>8&255]<<8|a[255&f])^r[h++],p=(a[p>>>24]<<24|a[u>>>16&255]<<16|a[f>>>8&255]<<8|a[255&l])^r[h++],t[e]=y,t[e+1]=v,t[e+2]=g,t[e+3]=p},keySize:8});t.AES=e._createHelper(r)}(),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Promise=t()}}(function(){return function t(e,r,n){function i(s,a){if(!r[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var f=r[s]={exports:{}};e[s][0].call(f.exports,function(t){var r=e[s][1][t];return i(r||t)},f,f.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){(function(t){"use strict";function r(){u=!0;for(var t,e,r=f.length;r;){for(e=f,f=[],t=-1;++t<r;)e[t]();r=f.length}u=!1}var n,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var o=0,s=new i(r),a=t.document.createTextNode("");s.observe(a,{characterData:!0}),n=function(){a.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){r(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(r,0)};else{var c=new t.MessageChannel;c.port1.onmessage=r,n=function(){c.port2.postMessage(0)}}var u,f=[];e.exports=function(t){1!==f.push(t)||u||n()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,r){"use strict";function n(){}function i(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,t!==n&&c(this,t)}function o(t,e,r){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function s(t,e,r){f(function(){var n;try{n=e(r)}catch(e){return l.reject(t,e)}n===t?l.reject(t,new TypeError("Cannot resolve promise with itself")):l.resolve(t,n)})}function a(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function c(t,e){function r(e){i||(i=!0,l.reject(t,e))}function n(e){i||(i=!0,l.resolve(t,e))}var i=!1,o=u(function(){e(n,r)});"error"===o.status&&r(o.value)}function u(t,e){var r={};try{r.value=t(e),r.status="success"}catch(t){r.status="error",r.value=t}return r}var f=t(1),l={},p=["REJECTED"],h=["FULFILLED"],d=["PENDING"];e.exports=i,i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){if("function"!=typeof t&&this.state===h||"function"!=typeof e&&this.state===p)return this;var r=new this.constructor(n);this.state!==d?s(r,this.state===h?t:e,this.outcome):this.queue.push(new o(r,t,e));return r},o.prototype.callFulfilled=function(t){l.resolve(this.promise,t)},o.prototype.otherCallFulfilled=function(t){s(this.promise,this.onFulfilled,t)},o.prototype.callRejected=function(t){l.reject(this.promise,t)},o.prototype.otherCallRejected=function(t){s(this.promise,this.onRejected,t)},l.resolve=function(t,e){var r=u(a,e);if("error"===r.status)return l.reject(t,r.value);var n=r.value;if(n)c(t,n);else{t.state=h,t.outcome=e;for(var i=-1,o=t.queue.length;++i<o;)t.queue[i].callFulfilled(e)}return t},l.reject=function(t,e){t.state=p,t.outcome=e;for(var r=-1,n=t.queue.length;++r<n;)t.queue[r].callRejected(e);return t},i.resolve=function(t){return t instanceof this?t:l.resolve(new this(n),t)},i.reject=function(t){var e=new this(n);return l.reject(e,t)},i.all=function(t){function e(t,e){r.resolve(t).then(function(t){s[e]=t,++a!==i||o||(o=!0,l.resolve(u,s))},function(t){o||(o=!0,l.reject(u,t))})}var r=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,o=!1;if(!i)return this.resolve([]);for(var s=new Array(i),a=0,c=-1,u=new this(n);++c<i;)e(t[c],c);return u},i.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r,i=t.length,o=!1;if(!i)return this.resolve([]);for(var s=-1,a=new this(n);++s<i;)r=t[s],e.resolve(r).then(function(t){o||(o=!0,l.resolve(a,t))},function(t){o||(o=!0,l.reject(a,t))});return a}},{1:1}]},{},[2])(2)}),function(){"use strict";var t={version:"1.0.1.1",author:"Leonardo Ciaccio",contact:"leonardo.ciaccio@gmail.com",license:"MIT",credits:["code.google.com/p/crypto-js","https://github.com/calvinmetcalf/lie"]},e={encrypt:function(t,e,r){return r||(r=t.password),r?CryptoJS.AES.encrypt(e,r):e},decrypt:function(t,e,r){return r||(r=t.password),r?CryptoJS.AES.decrypt(e,r).toString(CryptoJS.enc.Utf8):e},getNextID:function(t,r){var n=e.getDBtable(t,r);return n?n.length>0?n.sort(function(t,e){return e["#"]-t["#"]})[0]["#"]+1:0:null},isJSON:function(t){try{return JSON.parse(t())}catch(t){return null}},isUnique:function(t,e){return!e.unique||""==e.unique||t.every(function(t,r,n){return!t.unique||t.unique!=e.unique})},setDBtable:function(t,r,n){n=n||[];var i=t.storage,o=t.name+":"+r;try{var s=e.encrypt(t,JSON.stringify(n));return s||(s=JSON.stringify(n)),i[o]=s,!0}catch(t){return!1}},getDBtable:function(t,r){var n=t.storage,i=t.name+":"+r;return void 0===n[i]?[]:this.isJSON(function(){try{var r=e.decrypt(t,n[i]);return r||n[i]}catch(t){return n[i]}})},deepMerge:function(t,e){for(var r in e)try{e[r].constructor==Object?t[r]=deepMerge(t[r],e[r]):t[r]=e[r]}catch(n){t[r]=e[r]}return t}},r=function(e){return"object"!=typeof e&&(e={}),e.storage!=localStorage&&e.storage!=sessionStorage?this.storage=localStorage:this.storage=e.storage,this.name="string"!=typeof e.name||""==e.name?"localdbclass":e.name,this.change="function"!=typeof e.change?function(t,e,r,n){}:e.change,this.password=null,this.dev=t,this};r.prototype.add=function(t,r){if(!t)throw new Error("localdbclass.prototype.add : 'tablename' required !");var n=this;return new Promise(function(i,o){r=Array.isArray(r)?r:[r];var s=e.getDBtable(n,t);if(!s)return o(100);for(var a=[],c=0;c<r.length;c++){var u=r[c];if(e.isUnique(s,u)){var f=e.getNextID(n,t);if(null!==f){var l=e.deepMerge(u,{"#":f});s.push(l),a.push(l)}}}return e.setDBtable(n,t,s)?(n.change(t,a,"add",s),i(a)):o(101)})},r.prototype.update=function(t,r){if(!t)throw new Error("localdbclass.prototype.update : 'tablename' required !");var n=this;return new Promise(function(i,o){r=Array.isArray(r)?r:[r];var s=e.getDBtable(n,t);if(!s)return o(100);for(var a=[],c=0,u=0;u<s.length&&c<r.length;u++)for(var f=0;f<r.length;f++){var l=r[f];if(s[u]["#"]==l["#"]){c++;var p=s.slice();if(p.splice(u,1),!e.isUnique(p,l))continue;s[u]=e.deepMerge(s[u],l),a.push(s[u])}}return e.setDBtable(n,t,s)?(n.change(t,a,"update",s),i(a)):o(101)})},r.prototype.remove=function(t,r){if(!t)throw new Error("localdbclass.prototype.remove : Table name required !");var n=this;return new Promise(function(i,o){r=Array.isArray(r)?r:[r];var s=e.getDBtable(n,t);if(!s)return o(100);for(var a=[],c=0;c<r.length;c++){var u=s.findIndex(function(t){return t["#"]==r[c]});u>-1&&(a.push(s[u]),s.splice(u,1))}return e.setDBtable(n,t,s)?(n.change(t,a,"remove",s),i(a)):o(101)})},r.prototype.move=function(t,r,n){if(!t)throw new Error("localdbclass.prototype.move : Table name required !");if(!(r>-1&&n>-1))throw new Error("localdbclass.prototype.move : ID required !");var i=this;return new Promise(function(o,s){var a=e.getDBtable(i,t);if(!a)return s(100);var c=a.findIndex(function(t){return n==t["#"]});if(c<0)return s(4);var u=a.findIndex(function(t){return r==t["#"]});if(u<0)return s(5);if(u==c)return s(6);var f=a.splice(u,1);return a.splice(c,0,f[0]),e.setDBtable(i,t,a)?(i.change(t,f,"move",a),o(f)):s(101)})},r.prototype.invert=function(t,r,n){if(!t)throw new Error("localdbclass.prototype.invert : Table name required !");if(!(r>-1&&n>-1))throw new Error("localdbclass.prototype.invert : ID required !");var i=this;return new Promise(function(o,s){var a=e.getDBtable(i,t);if(!a)return s(100);var c=a.findIndex(function(t){return n==t["#"]});if(c<0)return s(4);var u,f,l=a.findIndex(function(t){return r==t["#"]});return l<0?s(5):l==c?s(6):(l>c?(u=a.splice(l,1),f=a.splice(c,1),a.splice(c,0,u[0]),a.splice(l,0,f[0])):(f=a.splice(c,1),u=a.splice(l,1),a.splice(l,0,f[0]),a.splice(c,0,u[0])),e.setDBtable(i,t,a)?(i.change(t,[u,f],"invert",a),o([u,f])):s(101))})},r.prototype.query=function(t,r,n){if(!t)throw new Error("localdbclass.prototype.query : Table name required !");var i=this;return new Promise(function(o,s){"function"!=typeof r&&(r=function(){return!0}),n||(n={}),n.offset=n.offset&&parseInt(n.offset)>0?parseInt(n.offset):0,n.limit=n.limit&&parseInt(n.limit)>0?parseInt(n.limit):-1,"disc"!==n.sort&&(n.sort="asc");var a=[],c=e.getDBtable(i,t);if(!c)return s(100);c.slice();n.sortby&&"string"==typeof n.sortby&&("asc"==n.sort?c.sort(function(t,e){return"string"==typeof t[n.sortby]&&"string"==typeof e[n.sortby]?t[n.sortby].localeCompare(e[n.sortby]):parseInt(t[n.sortby])-parseInt(e[n.sortby])}):c.sort(function(t,e){return"string"==typeof t[n.sortby]&&"string"==typeof e[n.sortby]?e[n.sortby].localeCompare(t[n.sortby]):parseInt(e[n.sortby])-parseInt(t[n.sortby])}));for(var u=n.offset;u<c.length&&(n.limit<0||u<n.limit);u++){var f=c[u];!0===r(f)&&a.push(f)}return o(a)})},r.prototype.encryptdb=function(t){var r=this;return new Promise(function(n,i){var o=r.storage,s={};for(var a in o)if(a.match(new RegExp("^"+r.name,"g")))try{var c=e.encrypt(r,o[a],t);if(!c)return i();s[a]=c}catch(t){return i()}for(var a in s)o[a]=s[a];return n()})},r.prototype.decryptdb=function(t){var r=this;return new Promise(function(n,i){var o=r.storage,s={};for(var a in o)if(a.match(new RegExp("^"+r.name,"g"))){try{if(JSON.parse(o[a])){s[a]=o[a];continue}}catch(t){}try{var c=e.decrypt(r,o[a],t);if(c){if(JSON.parse(c)){s[a]=c;continue}return i()}return i()}catch(t){return i()}}for(var a in s)o[a]=s[a];return n()})},r.prototype.getTable=function(t){if(!t)throw new Error("localdbclass.prototype.getTable : Table name required !");return e.getDBtable(this,t)},r.prototype.countRecords=function(t){if(!t)throw new Error("localdbclass.prototype.countRecords : Table name required !");var r=this;return new Promise(function(n,i){var o=e.getDBtable(r,t);return o?n(o.length):i(100)})},r.prototype.isEmpty=function(){var t=this.storage,e=[];for(var r in t)if(r.match(new RegExp("^"+this.name,"g"))){var n={};n[r]=t[r],e.push(n)}return e.length<1},r.prototype.export=function(){var t=this;return new Promise(function(e,r){var n=t.storage,i=[];for(var o in n)if(o.match(new RegExp("^"+t.name,"g"))){var s={};s[o]=n[o],i.push(s)}i.length<1&&e(null),e(JSON.stringify(i))})},r.prototype.import=function(t){var e=this;return new Promise(function(r,n){var i=e.storage;if("string"!=typeof t)throw new Error("localdbclass.prototype.import : require text format alldb");try{var o;JSON.parse(t).forEach(function(t){try{i[Object.keys(t)]=t[Object.keys(t)]}catch(t){}try{if(!o){var e=Object.keys(t).toString();o=e.split(":")[0]}}catch(t){}}),o&&(e.name=o)}catch(t){n("localdbclass.prototype.import : problems on import")}r(e.name)})},r.prototype.clear=function(t){var e=this;return new Promise(function(r,n){var i=e.storage;for(var o in i)(t&&o.match(new RegExp("^"+e.name+":"+t.toString()+"$","g"))||!t&&o.match(new RegExp("^"+e.name,"g")))&&i.removeItem(o);e.change(t,[],"clear",[]),r(e.name)})},r.prototype.isEncrypted=function(){var t=this;return new Promise(function(r,n){var i=t.storage,o=0,s=0;for(var a in i)a.match(new RegExp("^"+t.name,"g"))&&(o++,null===e.isJSON(function(){try{var t=decrypt(i[a]);return t||i[a]}catch(t){return i[a]}})&&s++);r([o,s])})},window.localdb=r}();
