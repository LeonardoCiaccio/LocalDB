var CryptoJS=CryptoJS||function(a,e){var t={},r=t.lib={},n=function(){},i=r.Base={extend:function(e){n.prototype=this;var t=new n;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes;if(e=e.sigBytes,this.clamp(),n%4)for(var i=0;i<e;i++)t[n+i>>>2]|=(r[i>>>2]>>>24-i%4*8&255)<<24-(n+i)%4*8;else if(65535<r.length)for(i=0;i<e;i+=4)t[n+i>>>2]=r[i>>>2];else t.push.apply(t,r);return this.sigBytes+=e,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=a.ceil(t/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(4294967296*a.random()|0);return new c.init(t,e)}}),o=t.enc={},s=o.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],n=0;n<e;n++){var i=t[n>>>2]>>>24-n%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new c.init(r,t/2)}},u=o.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],n=0;n<e;n++)r.push(String.fromCharCode(t[n>>>2]>>>24-n%4*8&255));return r.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new c.init(r,t)}},f=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},l=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,r=t.words,n=t.sigBytes,i=this.blockSize,o=n/(4*i);if(e=(o=e?a.ceil(o):a.max((0|o)-this._minBufferSize,0))*i,n=a.min(4*e,n),e){for(var s=0;s<e;s+=i)this._doProcessBlock(r,s);s=r.splice(0,e),t.sigBytes-=n}return new c.init(s,n)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=l.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(r){return function(e,t){return new r.init(t).finalize(e)}},_createHmacHelper:function(r){return function(e,t){return new p.HMAC.init(r,t).finalize(e)}}});var p=t.algo={};return t}(Math);!function(){var e=CryptoJS,c=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp(),e=[];for(var i=0;i<r;i+=3)for(var o=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<r;s++)e.push(n.charAt(o>>>6*(3-s)&63));if(t=n.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,r=this._map;(n=r.charAt(64))&&(-1!=(n=e.indexOf(n))&&(t=n));for(var n=[],i=0,o=0;o<t;o++)if(o%4){var s=r.indexOf(e.charAt(o-1))<<o%4*2,a=r.indexOf(e.charAt(o))>>>6-o%4*2;n[i>>>2]|=(s|a)<<24-i%4*8,i++}return c.create(n,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(o){function S(e,t,r,n,i,o,s){return((e=e+(t&r|~t&n)+i+s)<<o|e>>>32-o)+t}function B(e,t,r,n,i,o,s){return((e=e+(t&n|r&~n)+i+s)<<o|e>>>32-o)+t}function E(e,t,r,n,i,o,s){return((e=e+(t^r^n)+i+s)<<o|e>>>32-o)+t}function k(e,t,r,n,i,o,s){return((e=e+(r^(t|~n))+i+s)<<o|e>>>32-o)+t}for(var e=CryptoJS,t=(n=e.lib).WordArray,r=n.Hasher,n=e.algo,C=[],i=0;i<64;i++)C[i]=4294967296*o.abs(o.sin(i+1))|0;n=n.MD5=r.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var n=e[s=t+r];e[s]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}r=this._hash.words;var i,o,s=e[t+0],a=(n=e[t+1],e[t+2]),c=e[t+3],u=e[t+4],f=e[t+5],l=e[t+6],p=e[t+7],h=e[t+8],d=e[t+9],y=e[t+10],v=e[t+11],g=e[t+12],m=e[t+13],w=e[t+14],b=e[t+15],_=r[0],x=k(x=k(x=k(x=k(x=E(x=E(x=E(x=E(x=B(x=B(x=B(x=B(x=S(x=S(x=S(x=S(x=r[1],o=S(o=r[2],i=S(i=r[3],_=S(_,x,o,i,s,7,C[0]),x,o,n,12,C[1]),_,x,a,17,C[2]),i,_,c,22,C[3]),o=S(o,i=S(i,_=S(_,x,o,i,u,7,C[4]),x,o,f,12,C[5]),_,x,l,17,C[6]),i,_,p,22,C[7]),o=S(o,i=S(i,_=S(_,x,o,i,h,7,C[8]),x,o,d,12,C[9]),_,x,y,17,C[10]),i,_,v,22,C[11]),o=S(o,i=S(i,_=S(_,x,o,i,g,7,C[12]),x,o,m,12,C[13]),_,x,w,17,C[14]),i,_,b,22,C[15]),o=B(o,i=B(i,_=B(_,x,o,i,n,5,C[16]),x,o,l,9,C[17]),_,x,v,14,C[18]),i,_,s,20,C[19]),o=B(o,i=B(i,_=B(_,x,o,i,f,5,C[20]),x,o,y,9,C[21]),_,x,b,14,C[22]),i,_,u,20,C[23]),o=B(o,i=B(i,_=B(_,x,o,i,d,5,C[24]),x,o,w,9,C[25]),_,x,c,14,C[26]),i,_,h,20,C[27]),o=B(o,i=B(i,_=B(_,x,o,i,m,5,C[28]),x,o,a,9,C[29]),_,x,p,14,C[30]),i,_,g,20,C[31]),o=E(o,i=E(i,_=E(_,x,o,i,f,4,C[32]),x,o,h,11,C[33]),_,x,v,16,C[34]),i,_,w,23,C[35]),o=E(o,i=E(i,_=E(_,x,o,i,n,4,C[36]),x,o,u,11,C[37]),_,x,p,16,C[38]),i,_,y,23,C[39]),o=E(o,i=E(i,_=E(_,x,o,i,m,4,C[40]),x,o,s,11,C[41]),_,x,c,16,C[42]),i,_,l,23,C[43]),o=E(o,i=E(i,_=E(_,x,o,i,d,4,C[44]),x,o,g,11,C[45]),_,x,b,16,C[46]),i,_,a,23,C[47]),o=k(o,i=k(i,_=k(_,x,o,i,s,6,C[48]),x,o,p,10,C[49]),_,x,w,15,C[50]),i,_,f,21,C[51]),o=k(o,i=k(i,_=k(_,x,o,i,g,6,C[52]),x,o,c,10,C[53]),_,x,y,15,C[54]),i,_,n,21,C[55]),o=k(o,i=k(i,_=k(_,x,o,i,h,6,C[56]),x,o,b,10,C[57]),_,x,l,15,C[58]),i,_,m,21,C[59]),o=k(o,i=k(i,_=k(_,x,o,i,u,6,C[60]),x,o,v,10,C[61]),_,x,a,15,C[62]),i,_,d,21,C[63]);r[0]=r[0]+_|0,r[1]=r[1]+x|0,r[2]=r[2]+o|0,r[3]=r[3]+i|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32;var i=o.floor(r/4294967296);for(t[15+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t[14+(n+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(t.length+1),this._process(),t=(e=this._hash).words,r=0;r<4;r++)n=t[r],t[r]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return e},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}}),e.MD5=r._createHelper(n),e.HmacMD5=r._createHmacHelper(n)}(Math),function(){var e,t=CryptoJS,r=(e=t.lib).Base,u=e.WordArray,n=(e=t.algo).EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=(s=this.cfg).hasher.create(),n=u.create(),i=n.words,o=s.keySize,s=s.iterations;i.length<o;){a&&r.update(a);var a=r.update(e).finalize(t);r.reset();for(var c=1;c<s;c++)a=r.finalize(a),r.reset();n.concat(a)}return n.sigBytes=4*o,n}});t.EvpKDF=function(e,t,r){return n.create(r).compute(e,t)}}(),CryptoJS.lib.Cipher||function(e){var t=(h=CryptoJS).lib,r=t.Base,s=t.WordArray,n=t.BufferedBlockAlgorithm,i=h.enc.Base64,o=h.algo.EvpKDF,a=t.Cipher=n.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){n.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(n){return{encrypt:function(e,t,r){return("string"==typeof t?d:p).encrypt(n,e,t,r)},decrypt:function(e,t,r){return("string"==typeof t?d:p).decrypt(n,e,t,r)}}}});t.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=h.mode={},u=function(e,t,r){var n=this._iv;n?this._iv=void 0:n=this._prevBlock;for(var i=0;i<r;i++)e[t+i]^=n[i]},f=(t.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();f.Encryptor=f.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize;u.call(this,e,t,n),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+n)}}),f.Decryptor=f.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,i=e.slice(t,t+n);r.decryptBlock(e,t),u.call(this,e,t,n),this._prevBlock=i}}),c=c.CBC=f,f=(h.pad={}).Pkcs7={pad:function(e,t){for(var r,n=(r=(r=4*t)-e.sigBytes%r)<<24|r<<16|r<<8|r,i=[],o=0;o<r;o+=4)i.push(n);r=s.create(i,r),e.concat(r)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=a.extend({cfg:a.cfg.extend({mode:c,padding:f}),reset:function(){a.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=t.createEncryptor;else r=t.createDecryptor,this._minBufferSize=1;this._mode=r.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var l=t.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),p=(c=(h.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?s.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var r=s.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return l.create({ciphertext:e,salt:r})}},t.SerializableCipher=r.extend({cfg:r.extend({format:c}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);var i=e.createEncryptor(r,n);return t=i.finalize(t),i=i.cfg,l.create({ciphertext:t,key:r,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(r,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),h=(h.kdf={}).OpenSSL={execute:function(e,t,r,n){return n||(n=s.random(8)),e=o.create({keySize:t+r}).compute(e,n),r=s.create(e.words.slice(t),4*r),e.sigBytes=4*t,l.create({key:e,iv:r,salt:n})}},d=t.PasswordBasedCipher=p.extend({cfg:p.cfg.extend({kdf:h}),encrypt:function(e,t,r,n){return r=(n=this.cfg.extend(n)).kdf.execute(r,e.keySize,e.ivSize),n.iv=r.iv,(e=p.encrypt.call(this,e,t,r.key,n)).mixIn(r),e},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),r=n.kdf.execute(r,e.keySize,e.ivSize,t.salt),n.iv=r.iv,p.decrypt.call(this,e,t,r.key,n)}})}(),function(){for(var e=CryptoJS,t=e.lib.BlockCipher,r=e.algo,s=[],n=[],i=[],o=[],a=[],c=[],u=[],f=[],l=[],p=[],h=[],d=0;d<256;d++)h[d]=d<128?d<<1:d<<1^283;var y=0,v=0;for(d=0;d<256;d++){var g=(g=v^v<<1^v<<2^v<<3^v<<4)>>>8^255&g^99;s[y]=g;var m=h[n[g]=y],w=h[m],b=h[w],_=257*h[g]^16843008*g;i[y]=_<<24|_>>>8,o[y]=_<<16|_>>>16,a[y]=_<<8|_>>>24,c[y]=_,_=16843009*b^65537*w^257*m^16843008*y,u[g]=_<<24|_>>>8,f[g]=_<<16|_>>>16,l[g]=_<<8|_>>>24,p[g]=_,y?(y=m^h[h[h[b^m]]],v^=h[h[v]]):y=v=1}var x=[0,1,2,4,8,16,32,64,128,27,54];r=r.AES=t.extend({_doReset:function(){for(var e=(r=this._key).words,t=r.sigBytes/4,r=4*((this._nRounds=t+6)+1),n=this._keySchedule=[],i=0;i<r;i++)if(i<t)n[i]=e[i];else{var o=n[i-1];i%t?6<t&&4==i%t&&(o=s[o>>>24]<<24|s[o>>>16&255]<<16|s[o>>>8&255]<<8|s[255&o]):(o=s[(o=o<<8|o>>>24)>>>24]<<24|s[o>>>16&255]<<16|s[o>>>8&255]<<8|s[255&o],o^=x[i/t|0]<<24),n[i]=n[i-t]^o}for(e=this._invKeySchedule=[],t=0;t<r;t++)i=r-t,o=t%4?n[i]:n[i-4],e[t]=t<4||i<=4?o:u[s[o>>>24]]^f[s[o>>>16&255]]^l[s[o>>>8&255]]^p[s[255&o]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,o,a,c,s)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,u,f,l,p,n),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,n,i,o,s,a){for(var c=this._nRounds,u=e[t]^r[0],f=e[t+1]^r[1],l=e[t+2]^r[2],p=e[t+3]^r[3],h=4,d=1;d<c;d++){var y=n[u>>>24]^i[f>>>16&255]^o[l>>>8&255]^s[255&p]^r[h++],v=n[f>>>24]^i[l>>>16&255]^o[p>>>8&255]^s[255&u]^r[h++],g=n[l>>>24]^i[p>>>16&255]^o[u>>>8&255]^s[255&f]^r[h++];p=n[p>>>24]^i[u>>>16&255]^o[f>>>8&255]^s[255&l]^r[h++],u=y,f=v,l=g}y=(a[u>>>24]<<24|a[f>>>16&255]<<16|a[l>>>8&255]<<8|a[255&p])^r[h++],v=(a[f>>>24]<<24|a[l>>>16&255]<<16|a[p>>>8&255]<<8|a[255&u])^r[h++],g=(a[l>>>24]<<24|a[p>>>16&255]<<16|a[u>>>8&255]<<8|a[255&f])^r[h++],p=(a[p>>>24]<<24|a[u>>>16&255]<<16|a[f>>>8&255]<<8|a[255&l])^r[h++],e[t]=y,e[t+1]=v,e[t+2]=g,e[t+3]=p},keySize:8});e.AES=t._createHelper(r)}(),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Promise=e()}}(function(){return function o(s,a,c){function u(r,e){if(!a[r]){if(!s[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(f)return f(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var i=a[r]={exports:{}};s[r][0].call(i.exports,function(e){var t=s[r][1][e];return u(t||e)},i,i.exports,o,s,a,c)}return a[r].exports}for(var f="function"==typeof require&&require,e=0;e<c.length;e++)u(c[e]);return u}({1:[function(e,f,t){(function(t){"use strict";function r(){c=!0;for(var e,t,r=u.length;r;){for(t=u,u=[],e=-1;++e<r;)t[e]();r=u.length}c=!1}var n,e=t.MutationObserver||t.WebKitMutationObserver;if(e){var i=0,o=new e(r),s=t.document.createTextNode("");o.observe(s,{characterData:!0}),n=function(){s.data=i=++i%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){r(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(r,0)};else{var a=new t.MessageChannel;a.port1.onmessage=r,n=function(){a.port2.postMessage(0)}}var c,u=[];f.exports=function(e){1!==u.push(e)||c||n()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){"use strict";function u(){}function n(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,e!==u&&a(this,e)}function i(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function o(t,r,n){f(function(){var e;try{e=r(n)}catch(e){return l.reject(t,e)}e===t?l.reject(t,new TypeError("Cannot resolve promise with itself")):l.resolve(t,e)})}function s(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function a(t,e){function r(e){i||(i=!0,l.reject(t,e))}function n(e){i||(i=!0,l.resolve(t,e))}var i=!1,o=c(function(){e(n,r)});"error"===o.status&&r(o.value)}function c(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}var f=e(1),l={},p=["REJECTED"],h=["FULFILLED"],d=["PENDING"];(t.exports=n).prototype.catch=function(e){return this.then(null,e)},n.prototype.then=function(e,t){if("function"!=typeof e&&this.state===h||"function"!=typeof t&&this.state===p)return this;var r=new this.constructor(u);this.state!==d?o(r,this.state===h?e:t,this.outcome):this.queue.push(new i(r,e,t));return r},i.prototype.callFulfilled=function(e){l.resolve(this.promise,e)},i.prototype.otherCallFulfilled=function(e){o(this.promise,this.onFulfilled,e)},i.prototype.callRejected=function(e){l.reject(this.promise,e)},i.prototype.otherCallRejected=function(e){o(this.promise,this.onRejected,e)},l.resolve=function(e,t){var r=c(s,t);if("error"===r.status)return l.reject(e,r.value);var n=r.value;if(n)a(e,n);else{e.state=h,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},l.reject=function(e,t){e.state=p,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},n.resolve=function(e){return e instanceof this?e:l.resolve(new this(u),e)},n.reject=function(e){var t=new this(u);return l.reject(t,e)},n.all=function(e){function t(e,t){r.resolve(e).then(function(e){o[t]=e,++s!==n||i||(i=!0,l.resolve(c,o))},function(e){i||(i=!0,l.reject(c,e))})}var r=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var o=new Array(n),s=0,a=-1,c=new this(u);++a<n;)t(e[a],a);return c},n.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r,n=e.length,i=!1;if(!n)return this.resolve([]);for(var o=-1,s=new this(u);++o<n;)r=e[o],t.resolve(r).then(function(e){i||(i=!0,l.resolve(s,e))},function(e){i||(i=!0,l.reject(s,e))});return s}},{1:1}]},{},[2])(2)}),function(){"use strict";var t={version:"1.0.1.1",author:"Leonardo Ciaccio",contact:"leonardo.ciaccio@gmail.com",license:"MIT",credits:["code.google.com/p/crypto-js","https://github.com/calvinmetcalf/lie"]},p={encrypt:function(e,t,r){return r||(r=e.password),r?CryptoJS.AES.encrypt(t,r):t},decrypt:function(e,t,r){return r||(r=e.password),r?CryptoJS.AES.decrypt(t,r).toString(CryptoJS.enc.Utf8):t},getNextID:function(e,t){var r=p.getDBtable(e,t);return r?0<r.length?r.sort(function(e,t){return t["#"]-e["#"]})[0]["#"]+1:0:null},isJSON:function(e){try{return JSON.parse(e())}catch(e){return null}},isUnique:function(e,n){return!n.unique||""==n.unique||e.every(function(e,t,r){return!e.unique||e.unique!=n.unique})},setDBtable:function(e,t,r){r=r||[];var n=e.storage,i=e.name+":"+t;try{var o=p.encrypt(e,JSON.stringify(r));return o||(o=JSON.stringify(r)),n[i]=o,!0}catch(e){return!1}},getDBtable:function(t,e){var r=t.storage,n=t.name+":"+e;return void 0===r[n]?[]:this.isJSON(function(){try{var e=p.decrypt(t,r[n]);return e||r[n]}catch(e){return r[n]}})},deepMerge:function(t,r){for(var n in r)try{r[n].constructor==Object?t[n]=deepMerge(t[n],r[n]):t[n]=r[n]}catch(e){t[n]=r[n]}return t}},e=function(e){return"object"!=typeof e&&(e={}),e.storage!=localStorage&&e.storage!=sessionStorage?this.storage=localStorage:this.storage=e.storage,this.name="string"!=typeof e.name||""==e.name?"localdbclass":e.name,this.change="function"!=typeof e.change?function(e,t,r,n){}:e.change,this.password=null,this.dev=t,this};e.prototype.add=function(c,u){if(!c)throw new Error("localdbclass.prototype.add : 'tablename' required !");var f=this;return new Promise(function(e,t){u=Array.isArray(u)?u:[u];var r=p.getDBtable(f,c);if(!r)return t(100);for(var n=[],i=0;i<u.length;i++){var o=u[i];if(p.isUnique(r,o)){var s=p.getNextID(f,c);if(null!==s){var a=p.deepMerge(o,{"#":s});r.push(a),n.push(a)}}}return p.setDBtable(f,c,r)?(f.change(c,n,"add",r),e(n)):t(101)})},e.prototype.update=function(u,f){if(!u)throw new Error("localdbclass.prototype.update : 'tablename' required !");var l=this;return new Promise(function(e,t){f=Array.isArray(f)?f:[f];var r=p.getDBtable(l,u);if(!r)return t(100);for(var n=[],i=0,o=0;o<r.length&&i<f.length;o++)for(var s=0;s<f.length;s++){var a=f[s];if(r[o]["#"]==a["#"]){i++;var c=r.slice();if(c.splice(o,1),!p.isUnique(c,a))continue;r[o]=p.deepMerge(r[o],a),n.push(r[o])}}return p.setDBtable(l,u,r)?(l.change(u,n,"update",r),e(n)):t(101)})},e.prototype.remove=function(s,a){if(!s)throw new Error("localdbclass.prototype.remove : Table name required !");var c=this;return new Promise(function(e,t){a=Array.isArray(a)?a:[a];var r=p.getDBtable(c,s);if(!r)return t(100);for(var n=[],i=0;i<a.length;i++){var o=r.findIndex(function(e){return e["#"]==a[i]});-1<o&&(n.push(r[o]),r.splice(o,1))}return p.setDBtable(c,s,r)?(c.change(s,n,"remove",r),e(n)):t(101)})},e.prototype.move=function(s,a,c){if(!s)throw new Error("localdbclass.prototype.move : Table name required !");if(!(-1<a&&-1<c))throw new Error("localdbclass.prototype.move : ID required !");var u=this;return new Promise(function(e,t){var r=p.getDBtable(u,s);if(!r)return t(100);var n=r.findIndex(function(e){return c==e["#"]});if(n<0)return t(4);var i=r.findIndex(function(e){return a==e["#"]});if(i<0)return t(5);if(i==n)return t(6);var o=r.splice(i,1);return r.splice(n,0,o[0]),p.setDBtable(u,s,r)?(u.change(s,o,"move",r),e(o)):t(101)})},e.prototype.invert=function(a,c,u){if(!a)throw new Error("localdbclass.prototype.invert : Table name required !");if(!(-1<c&&-1<u))throw new Error("localdbclass.prototype.invert : ID required !");var f=this;return new Promise(function(e,t){var r=p.getDBtable(f,a);if(!r)return t(100);var n=r.findIndex(function(e){return u==e["#"]});if(n<0)return t(4);var i,o,s=r.findIndex(function(e){return c==e["#"]});return s<0?t(5):s==n?t(6):(n<s?(i=r.splice(s,1),o=r.splice(n,1),r.splice(n,0,i[0]),r.splice(s,0,o[0])):(o=r.splice(n,1),i=r.splice(s,1),r.splice(s,0,o[0]),r.splice(n,0,i[0])),p.setDBtable(f,a,r)?(f.change(a,[i,o],"invert",r),e([i,o])):t(101))})},e.prototype.query=function(s,a,c){if(!s)throw new Error("localdbclass.prototype.query : Table name required !");var u=this;return new Promise(function(e,t){"function"!=typeof a&&(a=function(){return!0}),c||(c={}),c.offset=c.offset&&0<parseInt(c.offset)?parseInt(c.offset):0,c.limit=c.limit&&0<parseInt(c.limit)?parseInt(c.limit):-1,"disc"!==c.sort&&(c.sort="asc");var r=[],n=p.getDBtable(u,s);if(!n)return t(100);n.slice();c.sortby&&"string"==typeof c.sortby&&("asc"==c.sort?n.sort(function(e,t){return"string"==typeof e[c.sortby]&&"string"==typeof t[c.sortby]?e[c.sortby].localeCompare(t[c.sortby]):parseInt(e[c.sortby])-parseInt(t[c.sortby])}):n.sort(function(e,t){return"string"==typeof e[c.sortby]&&"string"==typeof t[c.sortby]?t[c.sortby].localeCompare(e[c.sortby]):parseInt(t[c.sortby])-parseInt(e[c.sortby])}));for(var i=c.offset;i<n.length&&(c.limit<0||i<c.limit);i++){var o=n[i];!0===a(o)&&r.push(o)}return e(r)})},e.prototype.encryptdb=function(s){var a=this;return new Promise(function(e,t){var r=a.storage,n={};for(var i in r)if(i.match(new RegExp("^"+a.name,"g")))try{var o=p.encrypt(a,r[i],s);if(!o)return t();n[i]=o}catch(e){return t()}for(var i in n)r[i]=n[i];return e()})},e.prototype.decryptdb=function(s){var a=this;return new Promise(function(e,t){var r=a.storage,n={};for(var i in r)if(i.match(new RegExp("^"+a.name,"g"))){try{if(JSON.parse(r[i])){n[i]=r[i];continue}}catch(e){}try{var o=p.decrypt(a,r[i],s);if(o){if(JSON.parse(o)){n[i]=o;continue}return t()}return t()}catch(e){return t()}}for(var i in n)r[i]=n[i];return e()})},e.prototype.getTable=function(e){if(!e)throw new Error("localdbclass.prototype.getTable : Table name required !");return p.getDBtable(this,e)},e.prototype.countRecords=function(n){if(!n)throw new Error("localdbclass.prototype.countRecords : Table name required !");var i=this;return new Promise(function(e,t){var r=p.getDBtable(i,n);return r?e(r.length):t(100)})},e.prototype.isEmpty=function(){var s=this;return new Promise(function(e,t){var r=s.storage,n=[];for(var i in r)if(i.match(new RegExp("^"+s.name,"g"))){var o={};o[i]=r[i],n.push(o)}e(n.length<1)})},e.prototype.export=function(){var s=this;return new Promise(function(e,t){var r=s.storage,n=[];for(var i in r)if(i.match(new RegExp("^"+s.name,"g"))){var o={};o[i]=r[i],n.push(o)}n.length<1&&e(null),e(JSON.stringify(n))})},e.prototype.import=function(i){var o=this;return new Promise(function(e,t){var r=o.storage;if("string"!=typeof i)throw new Error("localdbclass.prototype.import : require text format alldb");try{var n;JSON.parse(i).forEach(function(e){try{r[Object.keys(e)]=e[Object.keys(e)]}catch(e){}try{if(!n){var t=Object.keys(e).toString();n=t.split(":")[0]}}catch(e){}}),n&&(o.name=n)}catch(e){t("localdbclass.prototype.import : problems on import")}e(o.name)})},e.prototype.clear=function(i){var o=this;return new Promise(function(e,t){var r=o.storage;for(var n in r)(i&&n.match(new RegExp("^"+o.name+":"+i.toString()+"$","g"))||!i&&n.match(new RegExp("^"+o.name,"g")))&&r.removeItem(n);o.change(i,[],"clear",[]),e(o.name)})},e.prototype.isEncrypted=function(){var s=this;return new Promise(function(e,t){var r=s.storage,n=0,i=0;for(var o in r)o.match(new RegExp("^"+s.name,"g"))&&(n++,null===p.isJSON(function(){try{var e=decrypt(r[o]);return e||r[o]}catch(e){return r[o]}})&&i++);e([n,i])})},window.localdb=e}();
